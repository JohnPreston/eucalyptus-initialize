---
# INIT Eucalyptus configuration file

- name: Define vCPU overcommit
  shell: echo "{{ ansible_processor_vcpus }} * {{ cpu_overcommit }}" | bc
  register: nc_vcpu
  tags:
  - initialization
  - euca_conf_file
  - overcommit
  when:
  - inventory_hostname in "{{ groups.nc }}"

- name: configure eucalyptus.conf
  template: src=eucalyptus.conf.j2 dest=/etc/eucalyptus/eucalyptus.conf
  tags:
  - initialization
  - euca_conf_file
